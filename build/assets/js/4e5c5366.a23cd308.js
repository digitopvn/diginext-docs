"use strict";(self.webpackChunkdiginext=self.webpackChunkdiginext||[]).push([[6471],{9613:(e,t,n)=>{n.d(t,{Zo:()=>u,kt:()=>h});var o=n(9496);function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function a(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function i(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?a(Object(n),!0).forEach((function(t){r(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):a(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function l(e,t){if(null==e)return{};var n,o,r=function(e,t){if(null==e)return{};var n,o,r={},a=Object.keys(e);for(o=0;o<a.length;o++)n=a[o],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(o=0;o<a.length;o++)n=a[o],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var p=o.createContext({}),s=function(e){var t=o.useContext(p),n=t;return e&&(n="function"==typeof e?e(t):i(i({},t),e)),n},u=function(e){var t=s(e.components);return o.createElement(p.Provider,{value:t},e.children)},m="mdxType",d={inlineCode:"code",wrapper:function(e){var t=e.children;return o.createElement(o.Fragment,{},t)}},c=o.forwardRef((function(e,t){var n=e.components,r=e.mdxType,a=e.originalType,p=e.parentName,u=l(e,["components","mdxType","originalType","parentName"]),m=s(n),c=r,h=m["".concat(p,".").concat(c)]||m[c]||d[c]||a;return n?o.createElement(h,i(i({ref:t},u),{},{components:n})):o.createElement(h,i({ref:t},u))}));function h(e,t){var n=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var a=n.length,i=new Array(a);i[0]=c;var l={};for(var p in t)hasOwnProperty.call(t,p)&&(l[p]=t[p]);l.originalType=e,l[m]="string"==typeof e?e:r,i[1]=l;for(var s=2;s<a;s++)i[s]=n[s];return o.createElement.apply(null,i)}return o.createElement.apply(null,n)}c.displayName="MDXCreateElement"},5265:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>p,contentTitle:()=>i,default:()=>d,frontMatter:()=>a,metadata:()=>l,toc:()=>s});var o=n(7366),r=(n(9496),n(9613));const a={sidebar_position:4},i="Deploy Environments",l={unversionedId:"deployment/deploy-environment",id:"deployment/deploy-environment",title:"Deploy Environments",description:"The tree",source:"@site/docs/deployment/deploy-environment.md",sourceDirName:"deployment",slug:"/deployment/deploy-environment",permalink:"/docs/deployment/deploy-environment",draft:!1,editUrl:"https://github.com/digitopvn/diginext-docs/tree/main/docs/deployment/deploy-environment.md",tags:[],version:"current",sidebarPosition:4,frontMatter:{sidebar_position:4},sidebar:"tutorialSidebar",previous:{title:"Diginext Github Actions",permalink:"/docs/deployment/github-actions"},next:{title:"Builds",permalink:"/docs/deployment/builds"}},p={},s=[{value:"The tree",id:"the-tree",level:2},{value:"Projects &amp; Apps",id:"projects--apps",level:2},{value:"Deploy Environments",id:"deploy-environments-1",level:2},{value:"Production environment &amp; the others",id:"production-environment--the-others",level:3},{value:"Prerelease Environment (Preview Environment)",id:"prerelease-environment-preview-environment",level:3},{value:"Each deploy environment contains these following information:",id:"each-deploy-environment-contains-these-following-information",level:3},{value:"Builds",id:"builds",level:2},{value:"Statuses",id:"statuses",level:3},{value:"Releases",id:"releases",level:2},{value:"Lifecycle",id:"lifecycle",level:3}],u={toc:s},m="wrapper";function d(e){let{components:t,...a}=e;return(0,r.kt)(m,(0,o.Z)({},u,a,{components:t,mdxType:"MDXLayout"}),(0,r.kt)("h1",{id:"deploy-environments"},"Deploy Environments"),(0,r.kt)("h2",{id:"the-tree"},"The tree"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"Workspaces",(0,r.kt)("ul",{parentName:"li"},(0,r.kt)("li",{parentName:"ul"},"Projects",(0,r.kt)("ul",{parentName:"li"},(0,r.kt)("li",{parentName:"ul"},"Apps",(0,r.kt)("ul",{parentName:"li"},(0,r.kt)("li",{parentName:"ul"},"Deploy Environments"),(0,r.kt)("li",{parentName:"ul"},"Builds"),(0,r.kt)("li",{parentName:"ul"},"Releases")))))))),(0,r.kt)("h2",{id:"projects--apps"},"Projects & Apps"),(0,r.kt)("p",null,"Some might be confused about these 2 definitions, but if you work with Microservices long enough, you will see this is easy to understand."),(0,r.kt)("p",null,"For example, one workspace can have many projects, one project can have many child applications, such as: front-end, back-end, API gateway, database, this service, that service, blah blah blah\u2026"),(0,r.kt)("p",null,"Simplify those \u201cmicro-services\u201d into projects & apps make it more \u201cdeveloper friendly\u201d and obviously improve ",(0,r.kt)("inlineCode",{parentName:"p"},"developer experience")," (dx)"),(0,r.kt)("h2",{id:"deploy-environments-1"},"Deploy Environments"),(0,r.kt)("p",null,"It is the environment where your apps are deployed to!"),(0,r.kt)("h3",{id:"production-environment--the-others"},"Production environment & the others"),(0,r.kt)("p",null,'When deploying to "other environments", your app will be visible to the public immediately. However, when you deploy to the "production" environment, it will only be visible in the ',(0,r.kt)("strong",{parentName:"p"},(0,r.kt)("em",{parentName:"strong"},'"prerelease" environment')),' and will only be rolled out to the "production" environment intentionally.'),(0,r.kt)("p",null,"Check out this ",(0,r.kt)("strong",{parentName:"p"},(0,r.kt)("em",{parentName:"strong"},"\u201cBlue Green Deployment\u201d"))," flow:"),(0,r.kt)("p",null,(0,r.kt)("img",{alt:"*Basically this is what happens when you deploy your app to production environment*",src:n(2473).Z,width:"2823",height:"1743"})),(0,r.kt)("p",null,(0,r.kt)("em",{parentName:"p"},"Basically this is what happens when you deploy your app to production environment")),(0,r.kt)("h3",{id:"prerelease-environment-preview-environment"},"Prerelease Environment (Preview Environment)"),(0,r.kt)("p",null,"This is the main different of production environment with the other environments, think about it like a ",(0,r.kt)("strong",{parentName:"p"},"previewed version")," of your production app. Take a look at the comparison below:"),(0,r.kt)("table",null,(0,r.kt)("thead",{parentName:"table"},(0,r.kt)("tr",{parentName:"thead"},(0,r.kt)("th",{parentName:"tr",align:null},"Prerelease Environment"),(0,r.kt)("th",{parentName:"tr",align:null},"Production Environment")))),(0,r.kt)("p",null,"| \u2022 New build\n\u2022 Same Kubernetes cluster\n\u2022 Same Kubernetes namespace\n\u2022 Same environment variables\n\u2022 Different Kubernetes pods\n\u2022 Different access URL endpoint | \u2022 Old build\n\u2022 Same Kubernetes cluster\n\u2022 Same Kubernetes namespace\n\u2022 Same environment variables\n\u2022 Different Kubernetes pods\n\u2022 Different access URL endpoint |"),(0,r.kt)("p",null,"So basically the ",(0,r.kt)("inlineCode",{parentName:"p"},"prerelease")," environment is the same with ",(0,r.kt)("inlineCode",{parentName:"p"},"production")," environment."),(0,r.kt)("aside",null,'\ud83d\udc49 **Why?** The purpose of this workflow is to ensure that your "prerelease" app undergoes a full test without any bugs, errors, or typographical issues. Once you have completed this process, you can confidently roll out your app to the public in the "production" environment.'),(0,r.kt)("h3",{id:"each-deploy-environment-contains-these-following-information"},"Each deploy environment contains these following information:"),(0,r.kt)("ol",null,(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},(0,r.kt)("strong",{parentName:"p"},"Cluster"),": the Kubernetes cluster which your app will be deployed to")),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},(0,r.kt)("strong",{parentName:"p"},"Namespace"),": the namespace in the Kubernetes cluster which your app will be deployed to (most of the time it\u2019s a slug of the parent project, unless you changed it)")),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},(0,r.kt)("strong",{parentName:"p"},"Domain"),": the domain to access your app (it could be Diginext generated domain or your own domain)")),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},(0,r.kt)("strong",{parentName:"p"},"SSL Issuer"),": the SSL issuer for your domain (most of the time it should be Let\u2019s Encrypts, unless to change it)")),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},(0,r.kt)("strong",{parentName:"p"},"Container Registry"),": where you store the container image of your application.")),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},(0,r.kt)("strong",{parentName:"p"},"Replicas"),": how many instances your app would be scaled to after deployments (on \u201cdevelopment\u201d environment, it\u2019s always 1)")),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},(0,r.kt)("strong",{parentName:"p"},"Resource Quotas")," (I called it \u201cSize\u201d - container size): simply is the amount of resource quotas which your apps can use."),(0,r.kt)("p",{parentName:"li"},"By default, it will be ",(0,r.kt)("inlineCode",{parentName:"p"},"1x"),", equivalent to ",(0,r.kt)("inlineCode",{parentName:"p"},"50m of CPU and 128MB of RAM"),"\nOther config would be: ",(0,r.kt)("inlineCode",{parentName:"p"},"2x, 3x, 4x, \u2026 ,10x"))),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},(0,r.kt)("strong",{parentName:"p"},"Environment Variables"),": ",(0,r.kt)("em",{parentName:"p"},"(should I need to explain it?)")),(0,r.kt)("p",{parentName:"li"},"This is an array of key pair value, similar to the ",(0,r.kt)("inlineCode",{parentName:"p"},"dotenv")," file you have within your project.")),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},(0,r.kt)("strong",{parentName:"p"},"Volumes:")," a persistent volume of your apps, where you can persist your data (such as user uploaded files)."))),(0,r.kt)("h2",{id:"builds"},"Builds"),(0,r.kt)("p",null,"Builds in Diginext are similar to the container images of your app, just with some additional metadata information of the source code, build date, build environment and the author."),(0,r.kt)("h3",{id:"statuses"},"Statuses"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"Start"),(0,r.kt)("li",{parentName:"ul"},"Building"),(0,r.kt)("li",{parentName:"ul"},"Success"),(0,r.kt)("li",{parentName:"ul"},"Failed")),(0,r.kt)("h2",{id:"releases"},"Releases"),(0,r.kt)("p",null,"When the builds are success, it will be converted to Releases before deploying."),(0,r.kt)("p",null,"So Releases are quite similar to builds, with some additional information such as:"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"Roll out time"),(0,r.kt)("li",{parentName:"ul"},"Author of the release"),(0,r.kt)("li",{parentName:"ul"},"The generated Kubernetes YAML files")),(0,r.kt)("p",null,"Think of it like a snapshot of your app\u2019s deployment, so when you want to roll back to any versions, you only need to select one release and roll it out."),(0,r.kt)("h3",{id:"lifecycle"},"Lifecycle"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"Undeployed"),(0,r.kt)("li",{parentName:"ul"},"Deploying"),(0,r.kt)("li",{parentName:"ul"},"Healthy"),(0,r.kt)("li",{parentName:"ul"},"Partial healthy"),(0,r.kt)("li",{parentName:"ul"},"Failed"),(0,r.kt)("li",{parentName:"ul"},"Crashed"),(0,r.kt)("li",{parentName:"ul"},"Unknown")))}d.isMDXComponent=!0},2473:(e,t,n)=>{n.d(t,{Z:()=>o});const o=n.p+"assets/images/blue-green-deploy-d7794d647eb9b18d619b286a0d49e374.png"}}]);